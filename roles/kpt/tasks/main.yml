---
- name: Download kpt binary
  ansible.builtin.get_url:
    #url: "https://storage.googleapis.com/kpt-dev/{{ kpt_version }}/{{ host_os }}_{{ host_arch }}/kpt"
    url: "https://github.com/GoogleContainerTools/kpt/releases/download/v{{ kpt_version }}/kpt_{{ host_os }}_{{ host_arch }}"
    #url: "https://github.com/GoogleContainerTools/kpt/releases/download/v{{ kpt_version }}/kpt_{{ host_os }}_{{ host_arch }}"
    #url: "https://i.jpillora.com/GoogleContainerTools/kpt@v{{ kpt_version }}!"
    #checksum: "{{ kubectl_checksum_binary }}"
    dest: "{{ tmp_directory }}/kpt"
    mode: 0600
  tags:
    - kpt

- name: Copy kpt binary to destination directory
  become: true
  ansible.builtin.copy:
    src: "{{ tmp_directory }}/{{ item }}"
    dest: "{{ bin_directory }}/{{ item }}"
    mode: "0755"
    owner: "root"
    group: "root"
    remote_src: true
  with_items:
    - kpt